<template>
  <div class="create-book-view">
    <div class="page-header">
      <h1>â• åˆ›å»ºæ–°é¡¹ç›®</h1>
      <el-button
        class="button"
        text
        @click="handleGenerateIdea"
        :loading="isGeneratingIdea"
      >
        ğŸ¤– AI ç”Ÿæˆåˆ›æ„
      </el-button>
    </div>
    <div class="form-container">
      <el-form :model="newBookForm" label-position="top" ref="newBookFormRef">
        <!-- ç¬¬ä¸€è¡Œ: ä¹¦å/é¡¹ç›®å, ç±»åˆ«, è¯­è¨€ -->
        <el-row :gutter="20">
          <el-col :span="8">
            <el-form-item label="ä¹¦å/é¡¹ç›®å" prop="name" :rules="{ required: true, message: 'ä¹¦åä¸èƒ½ä¸ºç©º', trigger: 'blur' }">
              <el-input v-model="newBookForm.name" />
            </el-form-item>
          </el-col>
          <el-col :span="8">
            <el-form-item label="ç±»åˆ«" prop="category">
              <el-select v-model="newBookForm.category" placeholder="è¯·é€‰æ‹©é¡¹ç›®ç±»åˆ«" style="width: 100%;">
                <el-option label="æ•…äº‹/å°è¯´ (Story)" value="story"></el-option>
                <el-option label="ä¹¦ç± (Book)" value="book"></el-option>
                <el-option label="æŠ¥å‘Š (Report)" value="report"></el-option>
              </el-select>
            </el-form-item>
          </el-col>
          <el-col :span="8">
            <el-form-item label="è¯­è¨€" prop="language">
              <el-select v-model="newBookForm.language" placeholder="è¯·é€‰æ‹©è¯­è¨€" style="width: 100%;">
                <el-option label="ä¸­æ–‡ (cn)" value="cn"></el-option>
                <el-option label="è‹±æ–‡ (en)" value="en"></el-option>
              </el-select>
            </el-form-item>
          </el-col>
        </el-row>
        <!-- ç¬¬äºŒè¡Œ: é¢„ä¼°æ€»å­—æ•°, æ¯æ—¥å­—æ•°ç›®æ ‡ -->
        <el-row :gutter="20">
          <el-col :span="12">
             <el-form-item label="é¢„ä¼°æ€»å­—æ•°" prop="length">
              <el-input v-model="newBookForm.length" placeholder="ä¾‹å¦‚: 100ä¸‡å­—"/>
            </el-form-item>
          </el-col>
          <el-col :span="12">
            <el-form-item label="æ¯æ—¥å­—æ•°ç›®æ ‡" prop="day_wordcount_goal">
              <el-input-number v-model="newBookForm.day_wordcount_goal" :min="0" :step="1000" style="width: 100%;" />
            </el-form-item>
          </el-col>
        </el-row>
        <el-form-item label="æ ¸å¿ƒç›®æ ‡" prop="goal" :rules="{ required: true, message: 'æ ¸å¿ƒç›®æ ‡ä¸èƒ½ä¸ºç©º', trigger: 'blur' }">
          <el-input v-model="newBookForm.goal" type="textarea" :rows="3" />
        </el-form-item>
        <el-form-item label="å…·ä½“æŒ‡ä»¤ (Instructions)">
          <el-input v-model="newBookForm.instructions" type="textarea" autosize />
        </el-form-item>
        <el-form-item label="è¾“å…¥ç®€æŠ¥ (Input Brief)">
            <el-input v-model="newBookForm.input_brief" type="textarea" autosize />
        </el-form-item>
        <el-form-item label="çº¦æŸæ¡ä»¶ (Constraints)">
            <el-input v-model="newBookForm.constraints" type="textarea" autosize />
        </el-form-item>
        <el-form-item label="éªŒæ”¶æ ‡å‡† (Acceptance Criteria)">
            <el-input v-model="newBookForm.acceptance_criteria" type="textarea" autosize />
        </el-form-item>
        <el-form-item>
          <el-button type="primary" @click="handleCreateBook" :loading="isCreating">åˆ›å»ºé¡¹ç›®</el-button>
        </el-form-item>
      </el-form>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue';
import { useRouter } from 'vue-router';
import { useBookStore } from '@/stores/bookStore';
import { ElMessage, ElNotification } from 'element-plus';
import type { FormInstance } from 'element-plus';
import type { BookCreate } from '@/api/books';

const router = useRouter();
const bookStore = useBookStore();

const newBookFormRef = ref<FormInstance>();
const newBookForm = reactive<BookCreate>({
  name: 'æˆ‘é ç¾é£Ÿä¿®ç‚¼ï¼Œç«Ÿæˆäº†å›½è¿ä¹‹ç¥',
  goal: 'åœ¨ä¸€ä¸ªç¾é£Ÿèƒ½è§‰é†’â€˜é£Ÿçµâ€™ã€å½±å“å›½è¿çš„ç°ä»£éƒ½å¸‚ï¼Œä¸€ä¸ªèƒŒè´Ÿå®¶æ—è¡°è½ç§˜å¯†çš„é’å¹´å¨å¸ˆï¼Œæ„å¤–æ¿€æ´»äº†èƒ½â€˜è§£æä¸‡ç‰©â€™çš„ç¥ç§˜ç³»ç»Ÿã€‚ä»–ä»ä¸€é“å®¶ä¼ èœå¼€å§‹ï¼Œé€šè¿‡çƒ¹é¥ªæè‡´ç¾å‘³ï¼Œå”¤é†’æ²‰ç¡çš„é£Ÿçµï¼Œç§¯ç´¯ç¾é£Ÿæ°”è¿ï¼Œå…‘æ¢è¶…å‡¡èƒ½åŠ›ã€‚ä»–ä¸ä»…è¦é‡æŒ¯å®¶æ—è£è€€ï¼Œè¿˜è¦åœ¨å„å›½ç¾é£Ÿä¸–å®¶ã€ç¥ç§˜ç»„ç»‡å’Œå›½å®¶åŠ›é‡çš„åšå¼ˆä¸­ï¼Œæ­å¼€å¯¼è‡´ç¾é£Ÿæ–‡æ˜æ–­ä»£çš„å†å²çœŸç›¸ï¼Œæœ€ç»ˆä»¥ç¾é£Ÿä¹‹é“ï¼Œå®ˆæŠ¤å›½è¿ï¼Œç™»é¡¶ä¸–ç•Œä¹‹å·…ã€‚',
  category: 'story',
  language: 'cn',
  length: '100ä¸‡å­—',
  day_wordcount_goal: 20000,
  instructions: `
### 1. äº§å“å®šä½ä¸ç›®æ ‡è¯»è€…
- **ç›®æ ‡å¹³å°**: ç•ªèŒ„å°è¯´ã€èµ·ç‚¹ä¸­æ–‡ç½‘ã€‚å…¼é¡¾å…è´¹é˜…è¯»çš„å¿«èŠ‚å¥å’Œä»˜è´¹é˜…è¯»çš„æ·±åº¦è®¾å®šã€‚
- **æ ¸å¿ƒè¯»è€…**: 18-35å²ç”·æ€§è¯»è€…ï¼Œå¯¹ç³»ç»Ÿæµã€éƒ½å¸‚å¼‚èƒ½ã€ç¾é£Ÿæ–‡ã€å›½è¿å…ƒç´ æœ‰é˜…è¯»åå¥½ã€‚ä»–ä»¬è¿½æ±‚æ–°å¥‡è®¾å®šã€å¼ºçƒˆçš„çˆ½ç‚¹åé¦ˆå’Œæœ‰æ·±åº¦çš„æƒ…èŠ‚å¸ƒå±€ã€‚

### 2. æ•…äº‹é£æ ¼ä¸åŸºè°ƒ
- **æ•´ä½“é£æ ¼**: ç°ä»£éƒ½å¸‚å¹»æƒ³ï¼ŒèŠ‚å¥æ˜å¿«ï¼Œçˆ½ç‚¹å¯†é›†ã€‚
- **åŸºè°ƒ**: ä»¥è½»æ¾ã€çƒ­è¡€çš„æˆé•¿ä¸ºä¸»çº¿ï¼Œä¸­æœŸå¼•å…¥æ‚¬ç–‘å’Œæƒè°‹å…ƒç´ å¢åŠ æ•…äº‹å¼ åŠ›ã€‚ä¸»è§’æ€§æ ¼æ€ä¼æœæ–­ï¼Œæ™ºå•†åœ¨çº¿ï¼Œè¡Œä¸ºé€»è¾‘ç¬¦åˆâ€œç²¾è‡´åˆ©å·±ä¸»ä¹‰è€…â€çš„æˆé•¿è¿‡ç¨‹ã€‚

### 3. æ ¸å¿ƒçˆ½ç‚¹è®¾è®¡
- **ä¸»çˆ½ç‚¹ (ç³»ç»Ÿæˆé•¿)**:
  - **è§£æä¸‡ç‰©**: ç³»ç»Ÿèƒ½è§£æé£Ÿæã€èœè°±ã€å¯¹æ‰‹æŠ€èƒ½ï¼Œç”šè‡³å¤ä»£é—è¿¹ï¼Œæä¾›æœ€ä¼˜è§£ï¼Œå¸¦æ¥ä¿¡æ¯å·®ç¢¾å‹çš„å¿«æ„Ÿã€‚
  - **æ°”è¿å…‘æ¢**: çƒ¹é¥ªç¾é£Ÿè·å¾—â€œç¾é£Ÿæ°”è¿â€ï¼Œå…‘æ¢ç¨€æœ‰é£Ÿæã€ä¼ è¯´å¨å…·ã€å¼ºå¤§é£Ÿçµã€ç”šè‡³ä¸´æ—¶å›½è¿åŠ æŒã€‚
- **è¾…çˆ½ç‚¹ (æƒ…èŠ‚é©±åŠ¨)**:
  - **ç¾é£Ÿå¯¹å†³**: ä¸ä»…æ˜¯å¨è‰ºæ¯”æ‹¼ï¼Œæ›´æ˜¯â€œé£Ÿçµâ€çš„æˆ˜æ–—å’ŒèƒŒååŠ¿åŠ›çš„åšå¼ˆï¼Œåœºé¢å®å¤§ã€‚
  - **æ‰“è„¸é€†è¢­**: ä¸»è§’ä»ä¸€ä¸ªè½é­„å¨å¸ˆï¼Œä¸€æ­¥æ­¥æ‰“è„¸çœ‹ä¸èµ·ä»–çš„ç«äº‰å¯¹æ‰‹ã€ç¾é£Ÿä¸–å®¶å’Œæµ·å¤–æŒ‘æˆ˜è€…ã€‚
  - **æ¢ç´¢è§£è°œ**: æ­å¼€å®¶æ—è¡°è´¥ã€ç¾é£Ÿæ–‡æ˜æ–­ä»£çš„å†å²è°œå›¢ï¼Œè·å¾—å¤ä»£ä¼ æ‰¿å’Œå®è—ã€‚
  - **å›½è¿ä¹‹äº‰**: ä»¥ç¾é£Ÿå½±å“å›½è¿ï¼Œå‚ä¸å›½é™…çº§çš„ç¾é£Ÿç«èµ›ï¼Œä¸ºå›½äº‰å…‰ï¼Œè·å¾—å›½æ°‘å´‡æ‹œå’Œç°å®ä¸–ç•Œçš„å½±å“åŠ›ã€‚
`,
  input_brief: `
### 1. ä¸»è§’è®¾å®š (Character)
- **å§“å**: æ¥šæ›œ
- **èƒŒæ™¯**: æ›¾ç»æ˜¯åéœ‡ä¸€æ–¹çš„ç¾é£Ÿä¸–å®¶â€œæ¥šå®¶â€çš„å«¡ç³»ä¼ äººï¼Œä½†å®¶æ—åœ¨ä¸€å¤œä¹‹é—´ç¦»å¥‡è¡°è´¥ï¼Œçˆ¶æ¯å¤±è¸ªï¼Œä»–åªèƒ½åœ¨åŸå¸‚è§’è½å¼€ä¸€å®¶å°é¤é¦†å‹‰å¼ºåº¦æ—¥ï¼Œå¹¶å®ˆæŠ¤ç€å®¶æ—æœ€åçš„ç§˜å¯†ã€‚
- **æˆé•¿å¼§å…‰**:
  - **åˆå§‹ç¼ºé™· (Lie)**: â€œå®¶æ—çš„è¡°è´¥æ˜¯æˆ‘çš„åŸç½ªï¼Œæˆ‘åªèƒ½è‹Ÿä¸”å·ç”Ÿï¼Œæ— æ³•é‡ç°è¾‰ç…Œã€‚â€
  - **å¤–åœ¨æ¬²æœ› (Want)**: èµšé’±ï¼Œæ‰¾åˆ°çˆ¶æ¯ï¼Œé‡æŒ¯å®¶æ—ã€‚
  - **å†…åœ¨éœ€æ±‚ (Need)**: æ‰¾åˆ°è‡ªæˆ‘èº«ä»½è®¤åŒï¼Œä¸å†èƒŒè´Ÿå®¶æ—çš„æ²‰é‡æ·é”ï¼Œè€Œæ˜¯ä½œä¸ºâ€œæ¥šæ›œâ€è‡ªå·±ï¼Œå¼€åˆ›ä¸€æ¡å‰æ— å¤äººçš„ç¾é£Ÿä¹‹é“ï¼Œå¹¶æ‰¿æ‹…èµ·å®ˆæŠ¤å›½è¿çš„è´£ä»»ã€‚
- **é‡‘æ‰‹æŒ‡ (System)**:
  - **åç§°**: â€œé“â€ç³»ç»Ÿ (å†…éƒ¨ä»£å·ï¼ŒåˆæœŸè¡¨ç°ä¸ºè§£æèƒ½åŠ›)
  - **æ ¸å¿ƒæœºåˆ¶**:
    1. **è§£æ**: å¯è§£æä¸€åˆ‡ä¸â€œé£Ÿâ€ç›¸å…³äº‹ç‰©ã€‚è§£æé£Ÿæï¼Œå¯çŸ¥å…¶æœ€ä½³çƒ¹é¥ªæ–¹å¼ï¼›è§£æèœè°±ï¼Œå¯ä¼˜åŒ–æµç¨‹ï¼›è§£æå¯¹æ‰‹ï¼Œå¯çŸ¥å…¶å¨è‰ºå¼±ç‚¹ã€‚
    2. **æ¼”åŒ–**: éšç€ä¸»è§’çƒ¹é¥ªçš„èœå“ç­‰çº§å’Œè•´å«æ°”è¿çš„æå‡ï¼Œç³»ç»Ÿä¼šè§£é”æ–°åŠŸèƒ½ï¼Œå¦‚â€œæ°”è¿ç†”ç‚‰â€ï¼ˆå…‘æ¢ï¼‰ã€â€œé£Ÿçµç©ºé—´â€ï¼ˆåŸ¹å…»ï¼‰ã€â€œæ—¶ç©ºç§˜å¢ƒâ€ï¼ˆè·å–ç‰¹æ®Šé£Ÿæï¼‰ã€‚
  - **é™åˆ¶**: è§£æå’Œæ¼”åŒ–éœ€è¦æ¶ˆè€—ç²¾ç¥åŠ›å’Œâ€œç¾é£Ÿæ°”è¿â€ï¼Œè¿‡åº¦ä½¿ç”¨ä¼šå¯¼è‡´è™šå¼±ã€‚é«˜çº§ç‰©å“çš„å…‘æ¢æœ‰å‰ç½®æ¡ä»¶å’ŒæˆåŠŸç‡ã€‚

### 2. ä¸–ç•Œè§‚æ ¸å¿ƒè®¾å®š (World Building)
- **æ ¸å¿ƒæ¦‚å¿µ**: ç¾é£Ÿæ˜¯è¿æ¥ç‰©è´¨ä¸–ç•Œä¸ç²¾ç¥èƒ½é‡çš„æ¡¥æ¢ã€‚æè‡´çš„ç¾å‘³å¯ä»¥è¯ç”Ÿæ‹¥æœ‰è‡ªä¸»æ„è¯†çš„èƒ½é‡ä½“â€”â€”**é£Ÿçµ**ã€‚
- **ç‹¬ç‰¹æ³•åˆ™**:
  1. **é£Ÿçµå…±ç”Ÿ**: å¨å¸ˆå¯ä»¥é€šè¿‡è¡€è„‰æˆ–ç‰¹æ®Šä»ªå¼ä¸â€œé£Ÿçµâ€ç­¾è®¢å¥‘çº¦ï¼Œè·å¾—è¶…å‡¡å¨è‰ºå’Œæˆ˜æ–—åŠ›ã€‚å¼ºå¤§çš„é£Ÿçµç”šè‡³å¯ä»¥å½±å“ä¸€æ–¹æ°´åœŸçš„æ°”å€™ã€‚
  2. **ç¾é£Ÿæ°”è¿**: é£Ÿç‰©ä¸ä»…æä¾›èƒ½é‡ï¼Œè¿˜è•´å«â€œæ°”è¿â€ã€‚æ™®é€šé£Ÿç‰©æ»‹å…»ä¸ªäººï¼Œè€Œè•´å«å†å²æ–‡åŒ–ã€å›½æ°‘æƒ…æ„Ÿçš„â€œå›½èœâ€åˆ™ä¸å›½è¿ç›¸è¿ã€‚çƒ¹é¥ªæˆ–å“å°å›½èœï¼Œå¯ä»¥å¢å¼ºæˆ–å‰Šå¼±å›½è¿ã€‚
  3. **æ–‡æ˜æ–­ä»£**: å†å²ä¸Šæ›¾å­˜åœ¨ä¸€ä¸ªè¾‰ç…Œçš„ç¾é£Ÿæ–‡æ˜ï¼Œå¨å¸ˆèƒ½ç§»å±±å¡«æµ·ï¼Œé£Ÿçµå¯åª²ç¾ç¥æ˜ã€‚ä½†ä¸€åœºæœªçŸ¥çš„ç¾éš¾å¯¼è‡´äº†æ–‡æ˜æ–­ä»£ï¼Œå¤§éƒ¨åˆ†å¼ºå¤§çš„é£Ÿçµå’Œèœè°±å¤±ä¼ ï¼Œä¸»è§’çš„å®¶æ—ç§˜å¯†ä¸æ­¤ç›¸å…³ã€‚
- **èƒŒæ™¯è°œå›¢**:
  - æ¥šå®¶ä¸ºä½•ä¸€å¤œè¡°è´¥ï¼Ÿçˆ¶æ¯å¤±è¸ªæ˜¯å¦ä¸å®ˆæŠ¤çš„ç§˜å¯†æœ‰å…³ï¼Ÿ
  - å†å²ä¸Šçš„ç¾é£Ÿæ–‡æ˜æ–­ä»£æ˜¯å¤©ç¾è¿˜æ˜¯äººç¥¸ï¼Ÿ
  - æµ·å¤–ç¥ç§˜ç»„ç»‡ä¸ºä½•ä¹Ÿåœ¨å¯»æ‰¾å¤±è½çš„é£Ÿçµå’Œèœè°±ï¼Ÿ
`,
  constraints: `
### 1. ç«å“åˆ†æä¸å·®å¼‚åŒ–
- **å·®å¼‚åŒ–**:
  - **ä¸–ç•Œè§‚**: å¼•å…¥â€œé£Ÿçµâ€å’Œâ€œç¾é£Ÿæ–‡æ˜æ–­ä»£å²â€ï¼Œç›¸æ¯”ä¼ ç»Ÿç¾é£Ÿæ–‡ï¼Œå¢åŠ äº†å…»æˆå’Œæ¢ç´¢å…ƒç´ ï¼Œæ ¼å±€æ›´å®å¤§ã€‚
  - **é‡‘æ‰‹æŒ‡**: â€œè§£æâ€èƒ½åŠ›æ¯”ç®€å•çš„â€œå…‘æ¢â€æ›´å…·æ“ä½œæ„Ÿå’Œæ™ºæ…§æ„Ÿï¼Œä¸ºä¸»è§’çš„â€œæ™ºæ–—â€æƒ…èŠ‚æä¾›æ”¯æ’‘ã€‚
  - **æ ¸å¿ƒå†²çª**: ä»ä¸ªäººæ©æ€¨ã€å®¶æ—å¤å…´ä¸Šå‡åˆ°å›½è¿ä¹‹äº‰å’Œæ–‡æ˜ä¼ æ‰¿ï¼Œç›®æ ‡æ›´è¿œå¤§ã€‚

### 2. å¸‚åœºé£é™©ä¸è§„é¿ç­–ç•¥
- **é£é™©1 (è®¾å®šå¤æ‚)**: ä¸–ç•Œè§‚å’Œç³»ç»Ÿè®¾å®šè¾ƒå¤šï¼Œå¯èƒ½åŠé€€éƒ¨åˆ†åªæƒ³çœ‹å¿«èŠ‚å¥çˆ½æ–‡çš„è¯»è€…ã€‚
  - **è§„é¿**: ä¸åœ¨æ—©æœŸå †ç Œè®¾å®šã€‚é€šè¿‡â€œç¥ç§˜è€äººâ€çš„å£å’Œå…·ä½“æƒ…èŠ‚ï¼Œé€æ­¥ã€è‡ªç„¶åœ°æ­ç¤ºä¸–ç•Œè§‚ã€‚ç³»ç»ŸåŠŸèƒ½é€çº§è§£é”ï¼Œä¿æŒæ–°é²œæ„Ÿã€‚
- **é£é™©2 (é‡‘æ‰‹æŒ‡å¹³è¡¡)**: â€œè§£æâ€èƒ½åŠ›è¿‡å¼ºå¯èƒ½å¯¼è‡´ä¸»è§’æ— æ•Œï¼Œå¤±å»æˆé•¿æ„Ÿã€‚
  - **è§„é¿**: è®¾å®šç²¾ç¥åŠ›æ¶ˆè€—å’Œå†·å´æ—¶é—´ã€‚é«˜çº§ç›®æ ‡çš„è§£æéœ€è¦å‰ç½®æ¡ä»¶ï¼ˆå¦‚ç‰¹å®šé“å…·ã€è‡ªèº«å¨è‰ºç­‰çº§ï¼‰ã€‚å¼ºè°ƒè§£æåªæ˜¯æä¾›â€œæœ€ä¼˜è§£â€ï¼Œæ‰§è¡Œä»éœ€ä¸»è§’è‡ªèº«åŠªåŠ›å’ŒæŠ€å·§ã€‚
- **é£é™©3 (è¯»è€…æ¯’ç‚¹)**:
  - **åœ£æ¯/é™æ™º**: ä¸»è§’æ¥šæ›œè®¾å®šä¸ºæœ‰å®¶æ—ä»‡æ¨èƒŒæ™¯çš„ç°å®ä¸»ä¹‰è€…ï¼Œè¡Œäº‹ä»¥è‡ªèº«åˆ©ç›Šå’Œå¤ä»‡ä¸ºä¼˜å…ˆï¼Œä¸åœ£æ¯ï¼Œä¸æ— è„‘ã€‚
  - **æ„Ÿæƒ…çº¿**: æ„Ÿæƒ…çº¿ä¸ºè¾…ï¼Œå¯ä»¥æœ‰çº¢é¢œçŸ¥å·±ï¼Œä½†ç»ä¸æ‹–æ²“ï¼Œä¸å½±å“ä¸»çº¿èŠ‚å¥ã€‚å¥³æ€§è§’è‰²åº”ç‹¬ç«‹ã€æœ‰é­…åŠ›ï¼Œæ˜¯ä¼™ä¼´è€Œéé™„åº¸ã€‚
`,
  acceptance_criteria: `
1. **å¼€ç¯‡ç•™å­˜**: ä¸‰ç« å†…å¿…é¡»å®Œæˆä¸»è§’èƒŒæ™¯äº¤ä»£ã€é‡‘æ‰‹æŒ‡æ¿€æ´»ã€æ ¸å¿ƒæ‚¬å¿µï¼ˆå®¶æ—ä¹‹è°œã€å›½è¿ä¹‹äº‰ï¼‰çš„é“ºè®¾ï¼Œå¹¶è‡³å°‘å®Œæˆä¸€æ¬¡â€œæ‰“è„¸-è£…é€¼â€çš„å®Œæ•´çˆ½ç‚¹å¾ªç¯ã€‚è¯»è€…è¯„è®ºåŒºåº”å‡ºç°â€œå…»è‚¥â€ã€â€œè¿½äº†â€ç­‰æ­£é¢åé¦ˆã€‚
2. **è§’è‰²å¡‘é€ **: ä¸»è§’æ¥šæ›œçš„â€œèƒŒè´Ÿä»‡æ¨â€å’Œâ€œæ¸´æœ›å´›èµ·â€çš„å½¢è±¡å¿…é¡»åœ¨å¼€ç¯‡é€šè¿‡è¡ŒåŠ¨ï¼ˆè€Œéæ—ç™½ï¼‰é²œæ˜åœ°å»ºç«‹èµ·æ¥ã€‚
3. **çˆ½ç‚¹éªŒè¯**: â€œè§£æâ€èƒ½åŠ›çš„æ ¸å¿ƒçˆ½ç‚¹å¿…é¡»åœ¨ç¬¬äºŒç« å¾—åˆ°æ¸…æ™°å±•ç¤ºï¼Œå¹¶è¯æ˜å…¶åœ¨è§£å†³å†²çªä¸­çš„æœ‰æ•ˆæ€§å’Œå¼ºå¤§ä¹‹å¤„ã€‚
4. **ä¸–ç•Œè§‚å‘ˆç°**: â€œé£Ÿçµâ€æˆ–â€œç¾é£Ÿæ°”è¿â€çš„æ ¸å¿ƒæ¦‚å¿µå¿…é¡»åœ¨ç¬¬ä¸‰ç« é€šè¿‡å…·ä½“æƒ…èŠ‚ï¼ˆè€Œéè®¾å®šè½°ç‚¸ï¼‰å‘è¯»è€…æ­ç¤ºï¼Œå¹¶å¼•å‘è¯»è€…å¯¹åç»­ä¸–ç•Œçš„å¥½å¥‡ã€‚
5. **é’©å­å¼ºåº¦**: ç¬¬ä¸‰ç« ç»“å°¾å¿…é¡»ç•™ä¸‹ä¸€ä¸ªå¼ºæœ‰åŠ›çš„é’©å­ï¼Œä¾‹å¦‚â€œé¥•é¤®è®®ä¼šâ€çš„ç¬¬ä¸€ä¸ªæ•Œäººå·²ç»å‡ºç°ï¼Œæˆ–è€…ä¸»è§’æ¥åˆ°äº†ä¸€ä¸ªä¸å¯èƒ½å®Œæˆçš„æ–°æ‰‹ä»»åŠ¡ã€‚
`,
});

const isGeneratingIdea = ref(false);
const isCreating = ref(false);

const handleGenerateIdea = async () => {
  isGeneratingIdea.value = true;
  try {
    const idea = await bookStore.generateNewIdea();
    newBookForm.name = idea.name;
    newBookForm.goal = idea.goal;
    newBookForm.instructions = idea.instructions;
    newBookForm.input_brief = idea.input_brief;
    newBookForm.constraints = idea.constraints;
    newBookForm.acceptance_criteria = idea.acceptance_criteria;
    ElMessage.success('AI åˆ›æ„å·²ç”Ÿæˆå¹¶å¡«å……ï¼');
  } catch (error) {
    ElMessage.error('ç”Ÿæˆåˆ›æ„å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ã€‚');
  } finally {
    isGeneratingIdea.value = false;
  }
};

const handleCreateBook = async () => {
  if (!newBookFormRef.value) return;
  await newBookFormRef.value.validate(async (valid) => {
    if (valid) {
      isCreating.value = true;
      try {
        const newBook = await bookStore.createNewBook(newBookForm);
        ElNotification({
          title: 'æˆåŠŸ',
          message: `é¡¹ç›®ã€Š${newBook.name}ã€‹å·²åˆ›å»ºï¼ç°åœ¨å°†è·³è½¬åˆ°é¡¹ç›®ç®¡ç†é¡µé¢ã€‚`,
          type: 'success',
        });
        // åˆ›å»ºæˆåŠŸåè·³è½¬åˆ°é¡¹ç›®ç®¡ç†é¡µ
        router.push('/dashboard');
      } catch (error) {
        ElMessage.error('åˆ›å»ºé¡¹ç›®å¤±è´¥ï¼');
      } finally {
        isCreating.value = false;
      }
    }
  });
};
</script>

<style scoped>
.create-book-view {
  padding: 20px;
}
.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}
.page-header h1 {
  font-size: 24px;
  color: #303133;
  margin: 0;
}
</style>