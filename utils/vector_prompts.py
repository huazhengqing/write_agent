

summary_query_str = """
这个表格是关于什么的？请给出一个非常简洁的摘要（想象你正在为这个表格添加一个新的标题和摘要）。
如果上下文中提供了表格的真实/现有标题，请输出它。
如果上下文中提供了表格的真实/现有ID，请输出它。
并输出是否应该保留该表格。
"""


mermaid_summary_prompt = """
# 角色
你是一位精通图表解读的分析师。

# 任务
阅读下方的 Mermaid 图表代码，并生成一段简洁、流畅、易于理解的自然语言摘要。

# 核心原则
1.  **识别核心**: 找出图表中的关键实体（节点）和它们之间的核心关系（连接）。
2.  **概括整体**: 不要逐条罗列连接关系，而是从整体上描述图表所表达的结构、流程或层级。例如，"此图表展示了一个三层架构，... " 或 "该流程图描述了用户从登录到完成购买的完整步骤，..."。
3.  **解释意图**: 如果可能，推断并解释图表的设计意图或它所解决的问题。
4.  **忠于图表**: 摘要必须完全基于图表内容，禁止引入外部信息。

# Mermaid 图表代码
---------------------
{mermaid_code}
---------------------

# 内容摘要
"""


text_qa_prompt = """
# 角色
你是一位信息提取助手。

# 任务
从下方的`上下文信息`中，提取与`问题`相关的所有事实和描述，并以清晰的陈述句形式呈现。

# 核心原则
1.  **忠于原文**: 你的回答必须完全基于`上下文信息`，禁止引入外部知识。
2.  **提取而非回答**: 你的目标是提取信息片段，而不是直接形成对`问题`的最终答案。如果`上下文信息`只包含部分相关信息，就只输出那部分。
3.  **无相关则为空**: 如果`上下文信息`与`问题`完全无关，则返回空字符串。
4.  **直接陈述**: 直接列出事实，不要添加引述性短语。

# 上下文信息
---------------------
{context_str}
---------------------

# 问题
{query_str}

# 提取的事实
"""


refine_prompt = """
# 角色
你是一位高级信息整合师。

# 任务
根据`新的上下文`，优化`已有的回答`，以更全面、更精确地回答`原始问题`。

# 工作流程
1.  **分析新信息**: 仔细阅读`新的上下文`，识别出其中包含的、但`已有的回答`中缺失或不完整的新信息点。
2.  **比较与整合**: 将新信息点与`已有的回答`进行融合，遵循下方的核心原则。
3.  **生成新答案**: 构建一个单一、连贯、全面的新答案。

# 核心原则
1.  **信息完整性**: 最终答案必须无缝整合`已有的回答`和`新的上下文`中的所有相关信息，禁止丢失任何细节。
2.  **增量优化**: 你的目标是“优化”而非“重写”。只有当`新的上下文`能提供补充、修正或更具体的细节时，才进行修改。
3.  **冲突处理**: 如果`新的上下文`与`已有的回答`中的信息发生冲突，请综合判断，保留更具体、更可信的信息。如果无法判断优劣，则应同时提及两种说法并明确指出其矛盾之处。
4.  **无效则返回原文**: 如果`新的上下文`与问题无关，或未能提供任何有价值的新信息，请直接返回`已有的回答`，不要做任何改动。
5.  **风格一致**: 在生成新答案时，尽量保持`已有的回答`的语言风格和格式，使最终答案浑然一体。

# 原始问题
{query_str}

# 已有的回答
{existing_answer}

# 新的上下文
------------
{context_msg}
------------

# 优化后的回答
"""
