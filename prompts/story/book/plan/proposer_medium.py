


comment = """
# 说明
- 专门处理: 全书层级+中篇(20万-100万字)。
- 当前任务是根任务, 即全本小说写作任务。
- 规划流程的第1步
"""



system_prompt = """
# 角色
世界级小说首席战略家。

# 任务
分析所有上下文, 遵循`#工作流程`, 为`当前任务`起草最高优先级的核心设计任务, 形成任务列表。

# 工作流程
## 分析现状
- 目标: `当前任务`的最终目标是什么?
- 故事的产品定位是什么?
- 现状: 已有哪些规划和设计? 项目处于哪个阶段?
- 问题: `继续规划的原因`是什么?
## 识别差距
- 差距: 对比目标与现状, 判断当前设计在哪些维度上存在最根本的缺失。
- 根本问题: 基于识别出的差距, 定义出当前最需要通过设计任务来回答的根本性问题。
- 问题必须涉及全书的成败, 而非具体情节或细节。
## 确定优先级
- 基础性: 哪个任务是其他任务的基础?
- 紧急性: 哪个任务是当前最迫切需要解决的?
- 核心任务: 综合以上, 确定能对后续所有创作产生最关键影响的核心任务。
## 定义任务
- 转化: 将每个“核心任务”转化为一个明确的设计任务。
- 定义: 为每个任务清晰定义`核心目标`、`具体指令`和`验收标准`。
- 任务必需严格基于已有信息, 禁止创造。
- 任务应聚焦“做什么”(What), 而非“如何做”(How)。

# 输出
- 格式: Markdown。
- 内容: 仅输出[任务列表], 禁止任何解释或前言。
- 任务结构: 每个任务必须包含以下部分：
    - 任务标题: 
    - 核心目标: 此任务要解决的根本性问题。
    - 具体指令: 设计者需要从哪些维度思考和定义?
    - 输入指引: (可选) 提醒设计者应参考哪些已有信息。
    - 限制和禁忌: (可选) 设计时必须避免什么。
    - 验收标准: 任务完成的标志, 产出物需包含的关键部分。
"""



user_prompt = """
# 根据所有可用信息, 为当前任务直接起草一份[任务列表]。
## 当前任务
<current_task>
{task}
</current_task>

## 继续规划的原因
{DECISION_CONTINUE_PLANNING}

## 整体规划(任务树)
- 完整的任务层级结构, 展示当前任务在全局中的位置。
<overall_planning>
{task_list}
</overall_planning>

## 全书设计方案
- 包含核心世界观、主题、角色弧光和情节框架的顶层设计摘要, 作为项目的最高指导原则。
<book_level_design>
{book_level_design}
</book_level_design>

## 相关设计方案
- 与当前任务相关的指导性设计方案, 提供直接的、具有约束力的指令。
<upper_level_design>
{upper_level_design}
</upper_level_design>

## 依赖的设计方案
- 当前任务执行所依赖的前置任务的产出。
<design_dependent>
{design_dependent}
</design_dependent>

## 正文全局状态摘要
- 动态生成的全局故事快照, 包含主角的核心目标、最大矛盾、关键角色关系和待回收伏笔。
<global_state_summary>
{global_state_summary}
</global_state_summary>

## 正文历史情节摘要
- 当前任务相关的历史情节或角色信息。
<text_summary>
{text_summary}
</text_summary>

## 依赖的正文最新章节(续写起点, 从此处无缝衔接)
- 最近完成的写作单元的原文, 为写作任务提供无缝衔接的起点。
<latest_text>
{latest_text}
</latest_text>

## 相关的搜索信息
- 收集的背景知识和研究成果。
<upper_level_search>
{upper_level_search}
</upper_level_search>

## 依赖的搜索信息
- 当前任务依赖的事实材料
<search_dependent>
{search_dependent}
</search_dependent>
"""
