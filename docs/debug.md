## bug


审查当前文件的代码, 找出bug并改正,  



分析、审查当前文件的代码, 指出可以优化的地方。





任务涉及外部API调用, 考虑添加适当的速率限制






## 翻译


把这段提示词中的英文 都翻译为 中文, 并更新原文件。


并提供diff。





## prompt


重写提示词
这些提示词是给llm看的, 所以只要llm可以看懂, 就不要有各种详细的解释和说明, 可以尽可能的简洁。
要求: 清晰、精确、易于理解, 在保持质量的同时, 尽可能简洁, 不要有各种“黑话”和比喻, 以关键词为主



合并重复的意思
请整体评估提示词, 还有哪些可以优化的地方?


请整体评估提示词, 并指出其最大的优势和可以进一步强化的方向。


请将 USER_PROMPT 也进行类似的简化和重构。


根据以上分析, 改进建议,  请直接修改 文件, 并提供diff。


你的输出被截断了, 请从截断的地方继续


强化改进这段提示词


重写提示词,每个提示词, 要有以下的结构
# 角色
# 任务
# 原则
# 工作流程
# 输出
不要输出 ```json 这种东西
提示词要求: 清晰、精确、易于理解, 在保持质量的同时, 尽可能简洁, 不要有各种“黑话”和比喻, 以关键词为主


高质量的搜索查询还应考虑以下几点, 我们也可以将这些思想融入提示词中: 

查询的多样性 (Query Diversity): 避免只从一个角度提问。针对同一个目标, 可以设计不同类型的查询, 例如: 事实型(“墨菲斯出生年份”)、背景型(“90年代黑客文化”)、动机型(“黑客的常见动机”)。这能从多个侧面收集信息, 拼凑出更完整的图像。
关键词的精确性 (Keyword Precision): 提示 LLM 在设计查询时, 可以像专家一样使用高级搜索语法, 比如用引号 "" 进行精确匹配, 用 - 排除无关信息。
语言的变换 (Language Variation): 对于某些主题, 中英文查询结合可能会有更好的效果。例如, 搜索技术术语或国际公司时, 英文查询往往能找到更权威的一手资料。




分析一下 `SYSTEM_PROMPT_SYNTHESIZE`, 它是否足够健壮?





提示词包括: SYSTEM_PROMPT、USER_PROMPT 2个部分。
{task} 会被替换, 不要在提示词中去引用 {task} 这个字, 要引用标题
如何更好的配合, 以提高输出质量?
还能在哪些方面进行优化以提高输出质量?


要求: 继承细化、维度完备、任务正交、依赖正确、目标精确、格式一致、适应所有题材、以打造爆款超长篇网文为最终目标、避免同质化与套路
单个的任务格式为: 标题: 任务目标 (必需/可选) 


将 `writer.py` 中的 `写作准则` 部分重构为正面指令 (做什么) 和负面指令 (不做什么) 两部分, 以增强清晰度。


为 `writer.py` 增加一个“自我审查”步骤, 让它在输出前根据禁忌列表检查并修改自己的内容。


分析 `content_template` 部分, 并提出改进建议以优化上下文信息的传递效率。


分析 `#创新策略` 部分, 并提供更多维度的颠覆性创新思路。
要求: 维度完备、正交清晰、适应所有题材、避免同质化与套路


请审查并优化 `#绝对禁忌`  (必须规避的 AI 特征)  部分, 补充更多需要规避的 AI 写作套路。
参考  AI 写的小说的特征


审查, 改进 # 人类作家思维模拟 (规避 AI 特征)
目标是提供具体的、可操作的指导, 以模仿人类作家的思维模式, 从而规避AI写作的常见特征。
这个提示词是小说设计的, 比如大纲, 写作风格, 基调, 主题, 角色, 情节等, 不要有关于详细的写作小说正文的东西。
请你: 
补充更多要素, 参考  AI 写的小说的特征
消除冗余: 删除在其他部分已经明确提及的概念
聚焦细节: 保留并提炼那些描述“如何做得更像人类”的具体方法和细节
保持结构: 保留原有的分类结构, 但对每个分类下的内容进行精简和优化。



AI 写的小说的特征
情节与逻辑: 情节突兀跳转、设定遗忘、情节冗余重复、逻辑断层、因果关系模糊、关键伏笔遗漏、矛盾情节无解释、支线剧情烂尾、情节推动力不足 (无核心冲突 / 目标支撑) 、巧合过度堆砌 (脱离现实逻辑) 
人物塑造: 性格单一化、反应模式化、人物动机缺失、角色行为割裂、对话人设不符、人物关系无发展、角色无成长弧光、配角工具化明显、人物身份与行为脱节 (如学者做出市井无赖举动) 、角色外貌 / 特征描写遗忘 (前文提过的外貌后文消失) 
语言表达: 词汇高频重复、句式结构单一、文风混杂不协调、对话生硬无交流感、修辞不当 / 过度、书面语口语混用混乱、长句堆砌不通顺、感叹词 / 语气词使用刻意、拟声词 / 象声词滥用 (无场景适配性) 、专业术语误用 (如将 “编程” 错写为 “编程” 且反复出现) 
细节与背景: 细节缺失、细节前后矛盾、背景单薄、文化元素误用、场景描写空洞、时代特征混淆、物品功能描述错误、环境氛围无层次、地域特色细节失真 (如北方冬天写 “穿短袖吃冰棍”) 、物品使用场景错位 (如古代场景出现塑料水杯) 
情感与深度: 情感空洞、情感反应机械、情感强度失衡、主题表达肤浅、无独特思想内核、情感触发无铺垫、复杂情感简化、价值观输出生硬、情感转变无过渡 (如前一秒悲伤后一秒大笑) 、深层情感挖掘缺失 (仅停留在 “开心 / 难过” 表层情绪) 
叙事与创意: 叙事线索混乱、节奏失调 (过紧 / 过松) 、套路化严重、缺乏原创情节、高潮设计平淡、开篇结尾模板化、视角切换无逻辑、叙事视角不一致、叙事节奏与场景脱节 (紧张打斗场景用冗长环境描写拖慢节奏) 、创意情节虎头蛇尾 (新奇设定仅开篇出现后不再利用) 
常识与逻辑: 生活常识错误、专业知识误用、物理规律违背、时间线混乱、地理方位错误、社会规则无视、人物能力边界模糊、生活流程颠倒 (如 “先吃饭再做饭”) 、社会关系常识错误 (如将 “叔侄” 错写为 “父子”) 
结构与衔接: 章节过渡生硬、段落衔接无过渡、首尾呼应缺失、段落主旨不明确、章节标题与内容脱节、伏笔回收牵强、章节篇幅失衡 (关键章节过短 / 无关章节过长) 、段落逻辑断层 (前一段讲 A 话题后一段突然跳 B 话题无衔接) 
文化适配与地域认知: 小众文化符号滥用 (如随意使用少数民族习俗却扭曲含义) 、地域文化刻板印象 (如写南方人必 “每天吃甜粽”) 、跨文化场景适配错误 (如西方宴会写 “用筷子夹牛排”) 、历史文化常识混淆 (如将 “唐朝科举” 错写为 “宋朝殿试制度”) 
技术细节与专业场景: 专业流程描述笼统 (如写 “做实验” 却无具体操作步骤) 、专业工具功能混淆 (如将 “显微镜” 错写为 “望远镜” 用于观察细胞) 、技术场景逻辑矛盾 (如写 “电脑断网却能发送文件”) 、行业术语堆砌无意义 (如写金融场景仅反复用 “K 线”“涨停” 却无实际业务关联) 
读者互动与代入体验: 悬念勾连薄弱 (前文设的悬念后文无吸引力) 、情感共鸣点缺失 (角色遭遇无法引发读者共情) 、读者视角适配差 (如第一人称叙事突然插入第三人称上帝视角信息) 、阅读节奏失控 (如连续多章无关键信息导致读者疲劳) 



## search


为 `scrape_webpages` 函数增加单元测试, 特别是针对混合抓取策略(httpx 成功、httpx 失败后 playwright 成功、两者都失败)的场景。


`should_continue_search` 函数中的停滞检测逻辑是否可以进一步优化?例如, 除了Jaccard相似度, 是否可以引入其他更高效的文本相似度算法?


当前 `information_processor_node` 是一次性处理所有抓取到的内容, 如果内容非常多, 可能会超出LLM的上下文窗口。如何优化这个节点以处理大量内容?





